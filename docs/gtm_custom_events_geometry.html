<script>
  (function () {
    var regionStateSelect = document.querySelector("[data-avert-region-state-select]"); // prettier-ignore
    var regionCountySelect = document.querySelector("[data-avert-region-county-select]"); // prettier-ignore
    var regionSelect = document.querySelector("[data-avert-region-select]");
    var stateSelect = document.querySelector("[data-avert-state-select]");
    var regionMap = document.querySelector("[data-avert-region-map]");
    var stateMap = document.querySelector("[data-avert-state-map]");

    if (
      !regionStateSelect ||
      !regionCountySelect ||
      !regionSelect ||
      !stateSelect ||
      !regionMap ||
      !stateMap
    ) {
      return;
    }

    regionStateSelect.addEventListener("change", function (ev) {
      window.dataLayer.push({
        event: "geographyRegionStateSelected",
        geographyRegionState: ev.target.options[ev.target.selectedIndex].value,
        geographyRegionCounty: undefined,
        geographyRegion: undefined,
        geographyState: undefined,
      });
    });

    regionCountySelect.addEventListener("change", function (ev) {
      window.dataLayer.push({
        event: "geographyRegionCountySelected",
        geographyRegionState: undefined,
        geographyRegionCounty: ev.target.options[ev.target.selectedIndex].value,
        geographyRegion: undefined,
        geographyState: undefined,
      });

      setTimeout(function () {
        regionSelect.dispatchEvent(new Event("change"));
      }, 100);
    });

    regionSelect.addEventListener("change", function (ev) {
      window.dataLayer.push({
        event: "geographyRegionSelected",
        geographyRegionState: undefined,
        geographyRegionCounty: undefined,
        geographyRegion: ev.target.options[ev.target.selectedIndex].value,
        geographyState: undefined,
      });
    });

    stateSelect.addEventListener("change", function (ev) {
      window.dataLayer.push({
        event: "geographyStateSelected",
        geographyRegionState: undefined,
        geographyRegionCounty: undefined,
        geographyRegion: undefined,
        geographyState: ev.target.options[ev.target.selectedIndex].value,
      });
    });

    regionMap.addEventListener("click", function (ev) {
      if (ev.target.parentNode.hasAttribute("data-region")) {
        window.dataLayer.push({
          event: "geographyRegionClicked",
          geographyRegionState: undefined,
          geographyRegionCounty: undefined,
          geographyRegion: ev.target.parentNode.getAttribute("data-region"),
          geographyState: undefined,
        });
      }
    });

    stateMap.addEventListener("click", function (ev) {
      if (ev.target.parentNode.hasAttribute("data-state")) {
        window.dataLayer.push({
          event: "geographyStateClicked",
          geographyRegionState: undefined,
          geographyRegionCounty: undefined,
          geographyRegion: undefined,
          geographyState: ev.target.parentNode.getAttribute("data-state"),
        });
      }
    });
  })();
</script>
